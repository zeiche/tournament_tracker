
; twilio dialplan configuration
; generated by bonjour_twilio module

[from-twilio]
; incoming calls from twilio
exten => _+1NXXNXXXXXX,1,NoOp(Incoming call from ${CALLERID(num)})
 same => n,Answer()
 same => n,Wait(1)
 same => n,AGI(/home/ubuntu/claude/tournament_tracker/asterisk_agi_handler.py)
 same => n,Hangup()

; handle dids
exten => _1NXXNXXXXXX,1,Goto(from-twilio,${EXTEN:1},1)
exten => _NXXNXXXXXX,1,Goto(from-twilio,+1${EXTEN},1)

; catch all
exten => _X.,1,NoOp(Unknown DID: ${EXTEN})
 same => n,Answer()
 same => n,Playback(ss-noservice)
 same => n,Hangup()

[to-twilio]
; outgoing calls via twilio
exten => _1NXXNXXXXXX,1,NoOp(Outgoing call to ${EXTEN})
 same => n,Set(CALLERID(num)=+1234567890)
 same => n,Dial(PJSIP/+${EXTEN}@twilio,60,T)
 same => n,Hangup()

exten => _NXXNXXXXXX,1,Goto(to-twilio,1${EXTEN},1)
exten => _+1NXXNXXXXXX,1,Goto(to-twilio,${EXTEN:1},1)

; international calls
exten => _011.,1,NoOp(International call to ${EXTEN})
 same => n,Set(CALLERID(num)=+1234567890)
 same => n,Dial(PJSIP/+${EXTEN:3}@twilio,60,T)
 same => n,Hangup()

[claude-twilio]
; claude integration context
exten => s,1,Answer()
 same => n,Wait(1)
 same => n,AGI(/home/ubuntu/claude/tournament_tracker/asterisk_agi_handler.py)
 same => n,Hangup()

; voice assistant direct line
exten => 2583,1,Goto(claude-twilio,s,1)
